geom_line(data = conservative_medium, aes(x = week, y = mean_diff, color = "firebrick1")) +
geom_line(data = conservative_large, aes(x = week, y = mean_diff, color = "darkred")) +
scale_color_discrete(name = "State",
breaks = c("darkorange", "firebrick1", "darkred"),
labels = c("Wyoming", "Oklahoma", "Texas")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(x = "Week",
y = "Polarization")
ggplot.multiplot(conservative, liberal)
ggplot2.multiplot(conservative, liberal)
library(easyGgplot2)
install_github("easyGgplot2")
install.packages("devtools")
library(devtools)
install_github("kassambara/easyGgplot2")
install_github("kassambara/easyGgplot2")
library(easyGgplot2)
ggplot2.multiplot(conservative, liberal)
ggplot2.multiplot(conservative, liberal, row = 2)
ggplot2.multiplot(conservative, liberal, cols = 1)
conservative <- ggplot(data = texas, aes(x = week, y = mean_diff)) +
ggtitle("Time Trend of Polarization in Conservative States") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(data = conservative_small, aes(x = week, y = mean_diff, color = "darkorange")) +
geom_line(data = conservative_medium, aes(x = week, y = mean_diff, color = "firebrick1")) +
geom_line(data = conservative_large, aes(x = week, y = mean_diff, color = "darkred")) +
scale_color_discrete(name = "State",
breaks = c("darkorange", "firebrick1", "darkred"),
labels = c("Wyoming", "Oklahoma", "Texas")) +
labs(x = "Week",
y = "Polarization")
conservative_small <- ideology_state %>%
filter(state_name == "Vermont" )
conservative_medium <- ideology_state %>%
filter(state_name == "Oregon" )
conservative_large <- ideology_state %>%
filter(state_name == "New York" )
liberal <- ggplot(data = texas, aes(x = week, y = mean_diff)) +
ggtitle("Time Trend of Polarization in Liberal States") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(data = conservative_small, aes(x = week, y = mean_diff, color = "darkorange")) +
geom_line(data = conservative_medium, aes(x = week, y = mean_diff, color = "firebrick1")) +
geom_line(data = conservative_large, aes(x = week, y = mean_diff, color = "darkred")) +
scale_color_discrete(name = "State",
breaks = c("darkorange", "firebrick1", "darkred"),
labels = c("Vermont", "Oregon", "New York")) +
labs(x = "Week",
y = "Polarization")
ggplot2.multiplot(conservative, liberal, cols = 1)
##Read File Function
#Hatecrime
Read_hatecrime <- function(directory){
data_list = list()
Files <- list.files(path = directory, pattern = "*.csv")
setwd(directory)
for(j in 1:length(Files)){
data <- fread(Files[[j]], sep = ",")
data$year <- substr(Files[[j]], nchar(Files[[j]]) - 7, nchar(Files[[j]]) - 4)
State = paste(toupper(substr(Files[[j]], 1, 1)), substr(Files[[j]], 2, nchar(Files[[j]]) - 9), sep = "")
data <- data %>%
mutate(state = State)
data_list[[j]] <- data
}
return(data_list)
}
Crime_path <- "/Volumes/ntu/研究/Master-Thesis---Political-Polarization-in-2016-US-Election/Data/Crime/"
crime <- Read_hatecrime(Crime_path)
month_char <- c("JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC")
df = data.frame()
crime_list = list()
for(i in 1:length(crime)){
data <- crime[[i]]
if(data$year[1] == 2015){
data <- data %>%
mutate(week = as.numeric(as.Date(substr(incident_date, 1, 10)) - as.Date("2015-05-03")) %/%7 + 1,
month = substr(incident_date, 6, 7))
}
else{
data <- data %>%
mutate(month = case_when(substr(INCIDENT_DATE, 4, 6) == "JAN" ~ "01",
substr(INCIDENT_DATE, 4, 6) == "FEB" ~ "02",
substr(INCIDENT_DATE, 4, 6) == "MAR" ~ "03",
substr(INCIDENT_DATE, 4, 6) == "APR" ~ "04",
substr(INCIDENT_DATE, 4, 6) == "MAY" ~ "05",
substr(INCIDENT_DATE, 4, 6) == "JUN" ~ "06",
substr(INCIDENT_DATE, 4, 6) == "JUL" ~ "07",
substr(INCIDENT_DATE, 4, 6) == "AUG" ~ "08",
substr(INCIDENT_DATE, 4, 6) == "SEP" ~ "09",
substr(INCIDENT_DATE, 4, 6) == "OCT" ~ "10",
substr(INCIDENT_DATE, 4, 6) == "NOV" ~ "11",
substr(INCIDENT_DATE, 4, 6) == "DEC" ~ "12",)) %>%
mutate(date = paste(year, "-", month, "-", substr(INCIDENT_DATE, 1, 2), sep = "")) %>%
mutate(week = as.numeric(as.Date(date) - as.Date("2015-05-03")) %/%7 + 1)
}
crime_list[[i]] <- data %>%
select("state", "year", "month", "week")
}
hatecrime <- fread("/Volumes/ntu/研究/Master-Thesis---Political-Polarization-in-2016-US-Election/Data/Hate Crime/Regression/hatecrime_reg_racial.csv")
hatecrime <- fread("/Volumes/ntu/研究/Master-Thesis---Political-Polarization-in-2016-US-Election/Data/Hate Crime/Regression/hatecrime_racial_reg.csv")
hate_crime <- hatecrime %>%
inner_join(ratio, by = c("week", "state_name"))
View(hate_crime)
write.csv(hate_crime, "/Volumes/ntu/研究/Master-Thesis---Political-Polarization-in-2016-US-Election/Data/Hate Crime/Regression/hatecrime_racial_reg.csv", row.names = FALSE)
crime_data <- rbindlist(crime_list) %>%
mutate(month_year = paste(year, month, sep = ""))
data <- crime_data %>%
count(week, state)
month_data <- crime_data %>%
count(month_year)
crime_trend <- ggplot(data = month_data, aes(x = month_year, group = 1)) +
ggtitle("2015-2017 Monthly Crime Trend in 35 States") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(aes(y = n), color = "blue") +
geom_point(aes(y = n), colour = "blue") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(x = "Month",
y = "Total Crime")
ggplot(data = month_data, aes(x = month_year, group = 1)) +
ggtitle("2015-2017 Monthly Crime Trend in 35 States") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(aes(y = n), color = "blue") +
geom_point(aes(y = n), colour = "blue") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(x = "Month",
y = "Total Crime")
View(hate)
Read_hatecrime <- function(directory){
data_list = list()
Files <- list.files(path = directory, pattern = "*.csv")
df = data.table()
for(j in 1:length(Files)){
setwd(directory)
data <- fread(Files[[j]], sep = ",")
data$year <- substr(Files[[j]], 1, 4)
df_list <- list(df, data)
df <- rbindlist(df_list)
}
return(df)
}
##Read Data
hatecrime_path_IR <- "/Volumes/ntu/研究/Master-Thesis---Political-Polarization-in-2016-US-Election/Data/Hate Crime/Cleaned Data/IR/"
IR <- Read_hatecrime(hatecrime_path_IR)
hatecrime_path_BH <- "/Volumes/ntu/研究/Master-Thesis---Political-Polarization-in-2016-US-Election/Data/Hate Crime/Cleaned Data/BH/"
BH <- Read_hatecrime(hatecrime_path_BH)
BH <- unique(BH)
hatecrime <- inner_join(IR, BH, by = c("agency", "year"))
hatecrime <- unique(hatecrime)
IR$date = as.character(IR$date)
IR <- IR %>%
mutate(date = paste(substr(date, 1, 4), "-", substr(date, 5, 6), "-", substr(date, 7, 8), sep = ""),
week = as.numeric(as.Date(date) - as.Date("2006-01-01")) %/%7 + 1,
month = as.numeric(substr(date, 6, 7)) + (as.numeric(year) - 2006) * 12,
month_year = substr(date, 6, 7),
state_name = case_when(state == 50 ~ "Alaska",
state == 1 ~ "Alabama",
state == 3 ~ "Arkansas",
state == 2 ~ "Arizona",
state == 4 ~ "California",
state == 5 ~ "Colorado",
state == 6 ~ "Connecticut",
state == 7 ~ "Delaware",
state == 9 ~ "Florida",
state == 10 ~ "Georgia",
state == 11 ~ "Idaho",
state == 51 ~ "Hawaii",
state == 12 ~ "Illinois",
state == 13 ~ "Indiana",
state == 14 ~ "Iowa",
state == 15 ~ "Kansas",
state == 16 ~ "Kentucky",
state == 17 ~ "Louisiana",
state == 18 ~ "Maine",
state == 19 ~ "Maryland",
state == 20 ~ "Massachusetts",
state == 21 ~ "Michigan",
state == 22 ~ "Minnesota",
state == 23 ~ "Mississippi",
state == 24 ~ "Missouri",
state == 25 ~ "Montana",
state == 26 ~ "Nebraska",
state == 27 ~ "Nevada",
state == 28 ~ "New Hampshire",
state == 29 ~ "New Jersey",
state == 30 ~ "New Mexico",
state == 31 ~ "New York",
state == 32 ~ "North Carolina",
state == 33 ~ "North Dakota",
state == 34 ~ "Ohio",
state == 35 ~ "Oklahoma",
state == 36 ~ "Oregon",
state == 37 ~ "Pennsylvania",
state == 38 ~ "Rhode Island",
state == 39 ~ "South Carolina",
state == 40 ~ "South Dakota",
state == 41 ~ "Tennessee",
state == 42 ~ "Texas",
state == 43 ~ "Utah",
state == 44 ~ "Vermont",
state == 45 ~ "Virginia",
state == 46 ~ "Washington",
state == 47 ~ "West Virginia",
state == 48 ~ "Wisconsin",
state == 49 ~ "Wyoming"))
ggplot(data = IR, aes(x = month)) +
ggtitle("2006-2017 Monthly Hate Crime Trend") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(stat = "count", colour = "blue") +
geom_point(stat = "count", colour = "blue") +
geom_vline(linetype = 3, xintercept = 12) +
geom_vline(linetype = 3, xintercept = 24) +
geom_vline(linetype = 3, xintercept = 36) +
geom_vline(linetype = 3, xintercept = 48) +
geom_vline(linetype = 3, xintercept = 60) +
geom_vline(linetype = 3, xintercept = 72) +
geom_vline(linetype = 3, xintercept = 84) +
geom_vline(linetype = 3, xintercept = 96) +
geom_vline(linetype = 3, xintercept = 108) +
geom_vline(linetype = 3, xintercept = 120) +
geom_vline(linetype = 3, xintercept = 132) +
geom_vline(linetype = 3, xintercept = 144) +
labs(x = "Month",
y = "Total Hate Crime")
IR_racial <- IR %>%
filter(motivation == 15 | motivation == 32 | motivation == 33  | motivation == 11  | motivation == 12  | motivation == 13  | motivation == 14)
ggplot(data = IR_racial, aes(x = month)) +
ggtitle("2006-2017 Monthly Racial Hate Crime Trend") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(stat = "count", colour = "blue") +
geom_point(stat = "count", colour = "blue") +
geom_vline(linetype = 3, xintercept = 12) +
geom_vline(linetype = 3, xintercept = 24) +
geom_vline(linetype = 3, xintercept = 36) +
geom_vline(linetype = 3, xintercept = 48) +
geom_vline(linetype = 3, xintercept = 60) +
geom_vline(linetype = 3, xintercept = 72) +
geom_vline(linetype = 3, xintercept = 84) +
geom_vline(linetype = 3, xintercept = 96) +
geom_vline(linetype = 3, xintercept = 108) +
geom_vline(linetype = 3, xintercept = 120) +
geom_vline(linetype = 3, xintercept = 132) +
geom_vline(linetype = 3, xintercept = 144) +
labs(x = "Month",
y = "Total Racial Hate Crime")
setwd("/Volumes/ntu/研究/Master-Thesis---Political-Polarization-in-2016-US-Election/Plot/Hate Crime/state_time_series/total/")
for(i in 1:51){
data = IR %>%
filter(state == i)
ggsave(paste(data$state_name[1], ".pdf", sep = ""),
assign(data$state_name, ggplot(data = data, aes(x = month)) +
ggtitle(data$state_name) +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(stat = "count", colour = "blue") +
geom_point(stat = "count", colour = "blue") +
geom_vline(linetype = 3, xintercept = 12) +
geom_vline(linetype = 3, xintercept = 24) +
geom_vline(linetype = 3, xintercept = 36) +
geom_vline(linetype = 3, xintercept = 48) +
geom_vline(linetype = 3, xintercept = 60) +
geom_vline(linetype = 3, xintercept = 72) +
geom_vline(linetype = 3, xintercept = 84) +
geom_vline(linetype = 3, xintercept = 96) +
geom_vline(linetype = 3, xintercept = 108) +
geom_vline(linetype = 3, xintercept = 120) +
geom_vline(linetype = 3, xintercept = 132) +
geom_vline(linetype = 3, xintercept = 144) +
labs(x = "Week",
y = "Total Hate Crime")))
}
setwd("/Volumes/ntu/研究/Master-Thesis---Political-Polarization-in-2016-US-Election/Plot/Hate Crime/state_time_series/racial/")
for(i in 1:51){
data = IR_racial %>%
filter(state == i)
ggsave(paste(data$state_name[1], "_racial.pdf", sep = ""),
assign(data$state_name, ggplot(data = data, aes(x = month)) +
ggtitle(data$state_name) +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(stat = "count", colour = "blue") +
geom_point(stat = "count", colour = "blue") +
geom_vline(linetype = 3, xintercept = 12) +
geom_vline(linetype = 3, xintercept = 24) +
geom_vline(linetype = 3, xintercept = 36) +
geom_vline(linetype = 3, xintercept = 48) +
geom_vline(linetype = 3, xintercept = 60) +
geom_vline(linetype = 3, xintercept = 72) +
geom_vline(linetype = 3, xintercept = 84) +
geom_vline(linetype = 3, xintercept = 96) +
geom_vline(linetype = 3, xintercept = 108) +
geom_vline(linetype = 3, xintercept = 120) +
geom_vline(linetype = 3, xintercept = 132) +
geom_vline(linetype = 3, xintercept = 144) +
labs(x = "Week",
y = "Total Racial Hate Crime")))
}
IR_total <- IR %>%
count(month_year, year)
IR_total <- merge(IR, IR_total, by = "month")
ggplot(data = IR_total) +
ggtitle("2006-2017 Monthly Racial Hate Crime Trend") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(mapping = aes(x = month_year, y = n, color = year)) +
geom_point(mapping = aes(x = month_year, y = n, color = year)) +
geom_vline(linetype = 3, xintercept = 12) +
geom_vline(linetype = 3, xintercept = 24) +
geom_vline(linetype = 3, xintercept = 36) +
geom_vline(linetype = 3, xintercept = 48) +
geom_vline(linetype = 3, xintercept = 60) +
geom_vline(linetype = 3, xintercept = 72) +
geom_vline(linetype = 3, xintercept = 84) +
geom_vline(linetype = 3, xintercept = 96) +
geom_vline(linetype = 3, xintercept = 108) +
geom_vline(linetype = 3, xintercept = 120) +
geom_vline(linetype = 3, xintercept = 132) +
geom_vline(linetype = 3, xintercept = 144) +
labs(x = "Month",
y = "Total Racial Hate Crime")
total <- ggplot(data = IR, aes(x = month)) +
ggtitle("2006-2017 Monthly Hate Crime Trend") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(stat = "count", colour = "blue") +
geom_point(stat = "count", colour = "blue") +
geom_vline(linetype = 3, xintercept = 12) +
geom_vline(linetype = 3, xintercept = 24) +
geom_vline(linetype = 3, xintercept = 36) +
geom_vline(linetype = 3, xintercept = 48) +
geom_vline(linetype = 3, xintercept = 60) +
geom_vline(linetype = 3, xintercept = 72) +
geom_vline(linetype = 3, xintercept = 84) +
geom_vline(linetype = 3, xintercept = 96) +
geom_vline(linetype = 3, xintercept = 108) +
geom_vline(linetype = 3, xintercept = 120) +
geom_vline(linetype = 3, xintercept = 132) +
geom_vline(linetype = 3, xintercept = 144) +
labs(x = "Month",
y = "Total Hate Crime")
total <- ggplot(data = IR, aes(x = month)) +
ggtitle("2006-2017 Monthly Hate Crime Trend") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(stat = "count", colour = "blue") +
geom_point(stat = "count", colour = "blue") +
geom_vline(linetype = 3, xintercept = 12) +
geom_vline(linetype = 3, xintercept = 24) +
geom_vline(linetype = 3, xintercept = 36) +
geom_vline(linetype = 3, xintercept = 48) +
geom_vline(linetype = 3, xintercept = 60) +
geom_vline(linetype = 3, xintercept = 72) +
geom_vline(linetype = 3, xintercept = 84) +
geom_vline(linetype = 3, xintercept = 96) +
geom_vline(linetype = 3, xintercept = 108) +
geom_vline(linetype = 3, xintercept = 120) +
geom_vline(linetype = 3, xintercept = 132) +
geom_vline(linetype = 3, xintercept = 144) +
labs(x = "Month",
y = "Total Hate Crime")
racial <- ggplot(data = IR_racial, aes(x = month)) +
ggtitle("2006-2017 Monthly Racial Hate Crime Trend") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(stat = "count", colour = "blue") +
geom_point(stat = "count", colour = "blue") +
geom_vline(linetype = 3, xintercept = 12) +
geom_vline(linetype = 3, xintercept = 24) +
geom_vline(linetype = 3, xintercept = 36) +
geom_vline(linetype = 3, xintercept = 48) +
geom_vline(linetype = 3, xintercept = 60) +
geom_vline(linetype = 3, xintercept = 72) +
geom_vline(linetype = 3, xintercept = 84) +
geom_vline(linetype = 3, xintercept = 96) +
geom_vline(linetype = 3, xintercept = 108) +
geom_vline(linetype = 3, xintercept = 120) +
geom_vline(linetype = 3, xintercept = 132) +
geom_vline(linetype = 3, xintercept = 144) +
labs(x = "Month",
y = "Total Racial Hate Crime")
total <- ggplot(data = IR, aes(x = month)) +
ggtitle("2006-2017 Monthly Hate Crime Trend") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(stat = "count", colour = "blue") +
geom_point(stat = "count", colour = "blue") +
geom_vline(linetype = 3, xintercept = 12) +
geom_vline(linetype = 3, xintercept = 24) +
geom_vline(linetype = 3, xintercept = 36) +
geom_vline(linetype = 3, xintercept = 48) +
geom_vline(linetype = 3, xintercept = 60) +
geom_vline(linetype = 3, xintercept = 72) +
geom_vline(linetype = 3, xintercept = 84) +
geom_vline(linetype = 3, xintercept = 96) +
geom_vline(linetype = 3, xintercept = 108) +
geom_vline(linetype = 3, xintercept = 120) +
geom_vline(linetype = 3, xintercept = 132) +
geom_vline(linetype = 3, xintercept = 144) +
labs(x = "Month",
y = "Total Hate Crime")
ggplot2.multiplot(total, racial, cols = 1)
conservative_small <- ideology_state %>%
filter(state_name == "Vermont" )
conservative_medium <- ideology_state %>%
filter(state_name == "Oregon" )
conservative_large <- ideology_state %>%
filter(state_name == "New York" )
liberal <- ggplot(data = texas, aes(x = week, y = mean_diff)) +
ggtitle("Time Trend of Polarization in Liberal States") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(data = conservative_small, aes(x = week, y = mean_diff, color = "darkorange")) +
geom_line(data = conservative_medium, aes(x = week, y = mean_diff, color = "firebrick1")) +
geom_line(data = conservative_large, aes(x = week, y = mean_diff, color = "darkred")) +
geom_vline(xintercept = 7, linetype = 3) +
geom_vline(xintercept = 80, linetype = 3) +
geom_text(aes(x=5, label="2015-06-16", y=1.2), angle=90, vjust = 1.2, text=element_text(size=5,  family="Times New Roman"))+
geom_text(aes(x=78, label="Election", y=1.1), angle=90, vjust = 1.2, text=element_text(size=5,  family="Times New Roman"))+
scale_color_discrete(name = "State",
breaks = c("darkorange", "firebrick1", "darkred"),
labels = c("Vermont", "Oregon", "New York")) +
labs(x = "Week",
y = "Polarization")
liberal <- ggplot() +
ggtitle("Time Trend of Polarization in Liberal States") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(data = conservative_small, aes(x = week, y = mean_diff, color = "darkorange")) +
geom_line(data = conservative_medium, aes(x = week, y = mean_diff, color = "firebrick1")) +
geom_line(data = conservative_large, aes(x = week, y = mean_diff, color = "darkred")) +
geom_vline(xintercept = 7, linetype = 3) +
geom_vline(xintercept = 80, linetype = 3) +
geom_text(aes(x=5, label="2015-06-16", y=1.2), angle=90, vjust = 1.2, text=element_text(size=5,  family="Times New Roman"))+
geom_text(aes(x=78, label="Election", y=1.1), angle=90, vjust = 1.2, text=element_text(size=5,  family="Times New Roman"))+
scale_color_discrete(name = "State",
breaks = c("darkorange", "firebrick1", "darkred"),
labels = c("Vermont", "Oregon", "New York")) +
labs(x = "Week",
y = "Polarization")
conservative <- ggplot() +
ggtitle("Time Trend of Polarization in Conservarive States") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(data = conservative_small, aes(x = week, y = mean_diff, color = "darkorange")) +
geom_line(data = conservative_medium, aes(x = week, y = mean_diff, color = "firebrick1")) +
geom_line(data = conservative_large, aes(x = week, y = mean_diff, color = "darkred")) +
geom_vline(xintercept = 7, linetype = 3) +
geom_vline(xintercept = 80, linetype = 3) +
geom_text(aes(x=5, label="2015-06-16", y=1.2), angle=90, vjust = 1.2, text=element_text(size=5,  family="Times New Roman"))+
geom_text(aes(x=78, label="Election", y=1.1), angle=90, vjust = 1.2, text=element_text(size=5,  family="Times New Roman"))+
scale_color_discrete(name = "State",
breaks = c("darkorange", "firebrick1", "darkred"),
labels = c("Wyoming", "Oklahoma", "Texas")) +
labs(x = "Week",
y = "Polarization")
ggplot2.multiplot(conservative, liberal, cols = 1)
conservative <- ggplot() +
ggtitle("Time Trend of Polarization in Conservarive States") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(data = conservative_small, aes(x = week, y = mean_diff, color = "darkorange")) +
geom_line(data = conservative_medium, aes(x = week, y = mean_diff, color = "firebrick1")) +
geom_line(data = conservative_large, aes(x = week, y = mean_diff, color = "darkred")) +
geom_vline(xintercept = 7, linetype = 3) +
geom_vline(xintercept = 80, linetype = 3) +
geom_text(aes(x=5, label="2015-06-16", y=1.2), angle=90, vjust = 1.2, text=element_text(size=3,  family="Times New Roman"))+
geom_text(aes(x=78, label="Election", y=1.1), angle=90, vjust = 1.2, text=element_text(size=3,  family="Times New Roman"))+
scale_color_discrete(name = "State",
breaks = c("darkorange", "firebrick1", "darkred"),
labels = c("Wyoming", "Oklahoma", "Texas")) +
labs(x = "Week",
y = "Polarization")
ggplot2.multiplot(conservative, liberal, cols = 1)
conservative <- ggplot() +
ggtitle("Time Trend of Polarization in Conservarive States") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(data = conservative_small, aes(x = week, y = mean_diff, color = "darkorange")) +
geom_line(data = conservative_medium, aes(x = week, y = mean_diff, color = "firebrick1")) +
geom_line(data = conservative_large, aes(x = week, y = mean_diff, color = "darkred")) +
geom_vline(xintercept = 7, linetype = 3) +
geom_vline(xintercept = 80, linetype = 3) +
scale_color_discrete(name = "State",
breaks = c("darkorange", "firebrick1", "darkred"),
labels = c("Wyoming", "Oklahoma", "Texas")) +
labs(x = "Week",
y = "Polarization")
conservative_small <- ideology_state %>%
filter(state_name == "Wyoming" )
conservative_medium <- ideology_state %>%
filter(state_name == "Oklahoma" )
conservative_large <- ideology_state %>%
filter(state_name == "Texas" )
conservative <- ggplot() +
ggtitle("Time Trend of Polarization in Conservarive States") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(data = conservative_small, aes(x = week, y = mean_diff, color = "darkorange")) +
geom_line(data = conservative_medium, aes(x = week, y = mean_diff, color = "firebrick1")) +
geom_line(data = conservative_large, aes(x = week, y = mean_diff, color = "darkred")) +
geom_vline(xintercept = 7, linetype = 3) +
geom_vline(xintercept = 80, linetype = 3) +
scale_color_discrete(name = "State",
breaks = c("darkorange", "firebrick1", "darkred"),
labels = c("Wyoming", "Oklahoma", "Texas")) +
labs(x = "Week",
y = "Polarization")
conservative_small <- ideology_state %>%
filter(state_name == "Vermont" )
conservative_medium <- ideology_state %>%
filter(state_name == "Oregon" )
conservative_large <- ideology_state %>%
filter(state_name == "New York" )
liberal <- ggplot() +
ggtitle("Time Trend of Polarization in Liberal States") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_line(data = conservative_small, aes(x = week, y = mean_diff, color = "darkorange")) +
geom_line(data = conservative_medium, aes(x = week, y = mean_diff, color = "firebrick1")) +
geom_line(data = conservative_large, aes(x = week, y = mean_diff, color = "darkred")) +
geom_vline(xintercept = 7, linetype = 3) +
geom_vline(xintercept = 80, linetype = 3) +
scale_color_discrete(name = "State",
breaks = c("darkorange", "firebrick1", "darkred"),
labels = c("Vermont", "Oregon", "New York")) +
labs(x = "Week",
y = "Polarization")
ggplot2.multiplot(conservative, liberal, cols = 1)
